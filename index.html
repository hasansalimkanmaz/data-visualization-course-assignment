<!DOCTYPE html>
<html>

<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
  <meta content="utf-8" http-equiv="encoding">
  <title>WHW Data Visualization Project</title>

  <script src="https://cdn.jsdelivr.net/npm/vega@5.19.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.0.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.15.1"></script>

</head>

<body>
  <div id="description">
    <h2>Abbreviations of Trust Features</h2>
    <ul>
      <li><b>trstprl:</b> Trust in country's parliament</li>
      <li><b>trstlgl:</b> Trust in the legal system</li>
      <li><b>trstplc:</b> Trust in the police</li>
      <li><b>trstplt:</b> Trust in politicians</li>
      <li><b>trstprt:</b> Trust in political parties</li>
      <li><b>trstep:</b> Trust in the European Parliament</li>
      <li><b>trstun:</b> Trust in the United Nations</li>
    </ul> 
  </div>
  <div id="vis">
  </div>
  <script type="text/javascript">
    var yourVlSpec = {
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "description": "An arc diagram depicting character co-occurrence in the novel Les MisÃ©rables.",
  "width": 1200,
  "height": 600,
  "padding": 10,
  "signals": [
    {
      "name": "active",
      "value": "null",
      "on": [
        {"events": "text:mouseover", "update": "datum.index"},
        {"events": "mouseover[!event.item]", "update": "null"}
      ]
    },
    {"name": "cx", "update": "width / 2"},
    {"name": "cy", "update": "height / 2"},
    {
      "name": "nodeRadius",
      "value": 8,
      "bind": {"input": "range", "min": 1, "max": 50, "step": 1}
    },
    {
      "name": "nodeCharge",
      "value": 80,
      "bind": {"input": "range", "min": -100, "max": 100, "step": 1}
    },
    {
      "name": "linkDistance",
      "value": 30,
      "bind": {"input": "range", "min": 5, "max": 300, "step": 1}
    },
    {"name": "static", "value": true, "bind": {"input": "checkbox"}},
    {
      "description": "State variable for active node fix status.",
      "name": "fix",
      "value": false,
      "on": [
        {
          "events": "symbol:mouseout[!event.buttons], window:mouseup",
          "update": "false"
        },
        {"events": "symbol:mouseover", "update": "fix || true"},
        {
          "events": "[symbol:mousedown, window:mouseup] > window:mousemove!",
          "update": "xy()",
          "force": true
        }
      ]
    },
    {
      "description": "Graph node most recently interacted with.",
      "name": "node",
      "value": null,
      "on": [
        {"events": "symbol:mouseover", "update": "fix === true ? item() : node"}
      ]
    },
    {
      "description": "Flag to restart Force simulation upon data changes.",
      "name": "restart",
      "value": false,
      "on": [{"events": {"signal": "fix"}, "update": "fix && fix.length"}]
    }
  ],
  "data": [
    {
      "name": "edges",
      "url": "https://raw.githubusercontent.com/hasansalimkanmaz/kul-dataviz/main/arc_plot_trst_vs_happiness.json",
      "format": {"type": "json", "property": "links"}
    },
    {
      "name": "sourceDegree",
      "source": "edges",
      "transform": [
        {
          "type": "aggregate",
          "groupby": ["source"],
          "fields": ["value"],
          "ops": ["sum"]
        }
      ]
    },
    {
      "name": "targetDegree",
      "source": "edges",
      "transform": [
        {
          "type": "aggregate",
          "groupby": ["target"],
          "fields": ["value"],
          "ops": ["sum"]
        }
      ]
    },
    {
      "name": "nodes",
      "url": "https://raw.githubusercontent.com/hasansalimkanmaz/kul-dataviz/main/arc_plot_trst_vs_happiness.json",
      "format": {"type": "json", "property": "nodes"},
      "transform": [
        {"type": "window", "ops": ["rank"], "as": ["order"]},
        {
          "type": "lookup",
          "from": "sourceDegree",
          "key": "source",
          "fields": ["index"],
          "as": ["sourceDegree"],
          "default": {"count": 0}
        },
        {
          "type": "lookup",
          "from": "targetDegree",
          "key": "target",
          "fields": ["index"],
          "as": ["targetDegree"],
          "default": {"count": 0}
        },
        {
          "type": "formula",
          "as": "sourceScore",
          "expr": "datum.sourceDegree.sum_value"
        },
        {
          "type": "formula",
          "as": "targetScore",
          "expr": "datum.targetDegree.sum_value * 0.5"
        }
      ]
    },
    {
      "name": "node-data",
      "url": "https://raw.githubusercontent.com/hasansalimkanmaz/kul-dataviz/main/network_plot_trst_to_only_trstprl.json",
      "format": {"type": "json", "property": "nodes"}
    },
    {
      "name": "link-data",
      "url": "https://raw.githubusercontent.com/hasansalimkanmaz/kul-dataviz/main/network_plot_trst_to_only_trstprl.json",
      "format": {"type": "json", "property": "links"}
    }
  ],
  "scales": [
    {
      "name": "position",
      "type": "band",
      "domain": {"data": "nodes", "field": "order", "sort": true},
      "range": "width"
    },
    {
      "name": "color",
      "type": "ordinal",
      "range": "category",
      "domain": {"data": "nodes", "field": "group"}
    },
    {
      "name": "color-network",
      "type": "ordinal",
      "domain": {"data": "node-data", "field": "group"},
      "range": {"scheme": "category20c"}
    }
  ],
  "layout": {"padding": 200, "bounds": "flush", "align": "none", "columns": 1},
  "marks": [
    {
      "type": "group",
      "style": "cell",
      "encode": {"enter": {"width": {"value": 1200}, "height": {"value": 400}}},
      "title": {
        "text": "Arc Plot",
        "frame": "group",
        "fontSize": {"value": 20}
      },
      "marks": [
        {
          "type": "symbol",
          "name": "layout",
          "interactive": false,
          "from": {"data": "nodes"},
          "encode": {
            "enter": {"opacity": {"value": 0}},
            "update": {
              "x": {"scale": "position", "field": "order"},
              "y": {"value": 400},
              "size": [
                {"test": "datum.group === 4", "field": "targetScore"},
                {"field": "sourceScore", "mult": 5, "offset": 0}
              ],
              "fill": {"scale": "color", "field": "group"}
            }
          }
        },
        {
          "type": "path",
          "from": {"data": "edges"},
          "encode": {
            "enter": {
              "stroke": {"value": "#000"},
              "strokeOpacity": {"value": 0.2},
              "strokeWidth": {"field": "value"}
            },
            "update": {
              "stroke": [
                {"test": "datum.source === active", "value": "red"},
                {"value": "steelblue"}
              ],
              "zindex": [
                {"test": "datum.source === active", "value": 2},
                {"value": 1}
              ]
            }
          },
          "transform": [
            {
              "type": "lookup",
              "from": "layout",
              "key": "datum.index",
              "fields": ["datum.source", "datum.target"],
              "as": ["sourceNode", "targetNode"]
            },
            {
              "type": "linkpath",
              "sourceX": {
                "expr": "min(datum.sourceNode.x, datum.targetNode.x)"
              },
              "targetX": {
                "expr": "max(datum.sourceNode.x, datum.targetNode.x)"
              },
              "sourceY": {"expr": "400"},
              "targetY": {"expr": "400"},
              "shape": "arc"
            }
          ]
        },
        {
          "type": "symbol",
          "from": {"data": "layout"},
          "encode": {
            "enter": {
              "x": {"field": "x"},
              "y": {"field": "y"},
              "fill": {"field": "fill"},
              "size": {"field": "size"}
            }
          }
        },
        {
          "type": "text",
          "from": {"data": "nodes"},
          "encode": {
            "enter": {
              "x": {"scale": "position", "field": "order"},
              "y": {"value": 415},
              "fontSize": {"value": 20},
              "align": {"value": "right"},
              "baseline": {"value": "middle"},
              "angle": {"value": -90},
              "text": {"field": "name"}
            },
            "update": {"fontSize": {"value": 15}}
          }
        }
      ]
    },
    {
      "type": "group",
      "style": "cell",
      "encode": {"enter": {"width": {"value": 1200}, "height": {"value": 600}}},
      "title": {
        "text": "Network plot",
        "frame": "group",
        "fontSize": {"value": 20}
      },
      "marks": [
        {
          "name": "nodes",
          "type": "symbol",
          "zindex": 1,
          "from": {"data": "node-data"},
          "clip": true,
          "on": [
            {
              "trigger": "fix",
              "modify": "node",
              "values": "fix === true ? {fx: node.x, fy: node.y} : {fx: fix[0], fy: fix[1]}"
            },
            {
              "trigger": "!fix",
              "modify": "node",
              "values": "{fx: null, fy: null}"
            }
          ],
          "encode": {
            "enter": {
              "fill": {"scale": "color-network", "field": "group"},
              "stroke": {"value": "white"}
            },
            "update": {
              "size": {"signal": "2 * nodeRadius * nodeRadius"},
              "cursor": {"value": "pointer"}
            }
          },
          "transform": [
            {
              "type": "force",
              "iterations": 300,
              "restart": {"signal": "restart"},
              "static": {"signal": "static"},
              "signal": "force",
              "forces": [
                {
                  "force": "center",
                  "x": {"signal": "cx"},
                  "y": {"signal": "cy"}
                },
                {"force": "collide", "radius": {"signal": "nodeRadius"}},
                {"force": "nbody", "strength": {"signal": "nodeCharge"}},
                {
                  "force": "link",
                  "links": "link-data",
                  "distance": {"signal": "linkDistance"}
                }
              ]
            }
          ]
        },
        {
          "type": "path",
          "clip": true,
          "from": {"data": "link-data"},
          "interactive": false,
          "encode": {
            "update": {
              "stroke": {"value": "#ccc"},
              "strokeWidth": {"value": 0.5}
            }
          },
          "transform": [
            {
              "type": "linkpath",
              "require": {"signal": "force"},
              "shape": "line",
              "sourceX": "datum.source.x",
              "sourceY": "datum.source.y",
              "targetX": "datum.target.x",
              "targetY": "datum.target.y"
            }
          ]
        },
        {
          "type": "text",
          "clip": true,
          "from": {"data": "nodes"},
          "encode": {
            "update": {
              "x": {"field": "x", "offset": 4},
              "y": {"field": "y"},
              "text": {"field": "datum.name"},
              "fontSize": {"value": 10}
            }
          }
        }
      ]
    }
  ]
}


    vegaEmbed('#vis', yourVlSpec);

    var view = new vega.View(vega.parse(yourVlSpec));
    view.runAsync(); // evaluate and render the view

  </script>







</body>

</html>